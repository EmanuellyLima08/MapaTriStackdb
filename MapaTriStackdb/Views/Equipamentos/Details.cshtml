@model MapaTriStackdb.Models.Equipamento

@{
    ViewData["Title"] = "Detalhes do Equipamento";
}

<h1>Detalhes do Equipamento</h1>

<div>
    <h4>Equipamento</h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Descricao)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Descricao)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Temperatura)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Temperatura)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Ar)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Ar)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Agua)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Agua)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Latitude)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Latitude)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Longitude)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Longitude)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Vento)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Vento)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Luz)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Luz)</dd>

        <dt class="col-sm-2">@Html.DisplayNameFor(model => model.Solo)</dt>
        <dd class="col-sm-10">@Html.DisplayFor(model => model.Solo)</dd>

        <dt class="col-sm-2">Cliente</dt>
        <dd class="col-sm-10">@Model.Cliente?.Nome</dd>
    </dl>
</div>

<hr />

<h4>Médias Gerais</h4>
@if (Model.MediasGerais != null && Model.MediasGerais.Any())
{
    var media = Model.MediasGerais.FirstOrDefault(m => m.ClienteId == Model.ClienteId);
    if (media != null)
    {
        <dl class="row">
            <dt class="col-sm-2">Média de Temperatura</dt>
            <dd class="col-sm-10">@media.MediaTemperatura °C</dd>

            <dt class="col-sm-2">Média de Umidade do Ar</dt>
            <dd class="col-sm-10">@media.MediaAr %</dd>

            <dt class="col-sm-2">Média de Água</dt>
            <dd class="col-sm-10">@media.MediaAgua %</dd>

            <dt class="col-sm-2">Média de Vento</dt>
            <dd class="col-sm-10">@media.MediaVento km/h</dd>

            <dt class="col-sm-2">Média de Luminosidade</dt>
            <dd class="col-sm-10">@media.MediaLuz lux</dd>

            <dt class="col-sm-2">Média de Solo</dt>
            <dd class="col-sm-10">@media.MediaSolo %</dd>
        </dl>
    }
    else
    {
        <p>Não há médias registradas para este equipamento.</p>
    }
}
else
{
    <p>Não há médias registradas para este equipamento.</p>
}

<hr />

<h4>Histórico de Leituras</h4>
@if (Model.Historicos != null && Model.Historicos.Any())
{
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Data</th>
                <th>Temperatura</th>
                <th>Ar</th>
                <th>Água</th>
                <th>Vento</th>
                <th>Luz</th>
                <th>Solo</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var h in Model.Historicos.OrderByDescending(h => h.DataLeitura))
            {
                <tr>
                    <td>@h.DataLeitura?.ToString("dd/MM/yyyy HH:mm")</td>
                    <td>@h.Temperatura</td>
                    <td>@h.Ar</td>
                    <td>@h.Agua</td>
                    <td>@h.Vento</td>
                    <td>@h.Luz</td>
                    <td>@h.Solo</td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <p>Não há registros de histórico para este equipamento.</p>
}

<hr />

<div>
    <a asp-action="Edit" asp-route-id="@Model?.EquipamentoId" class="btn btn-primary">Editar</a>
    <a asp-action="Index" class="btn btn-secondary">Voltar à Lista</a>
</div>
